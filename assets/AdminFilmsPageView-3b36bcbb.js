import{u as K}from"./general-4d5aa9bd.js";import{l as A,_ as P,a as q}from"./TextareaComponent-0882fd6c.js";import{u as T,a as J,_ as g,F as O}from"./vee-validate-42a3978c.js";import{_ as D}from"./ImageUpload-6e248471.js";import{_ as X}from"./RadioComponent-8f4796b3.js";import{o as u,e as r,F as I,k as M,b as t,t as N,d as V,f as R,r as $,s as z,l as H,h as i,i as Q,j as W,a as Y}from"./index-57ff8659.js";import{r as S,d as L,J as Z,f as C,u as F,c as ee,a as le}from"./index-08899976.js";import{v as E}from"./v4-a960c1f4.js";import"./index-8d32edcd.js";const ae={class:"d-flex position-relative mb-3"},se={class:"input-group mr-3"},te={class:"input-group-prepend"},oe={class:"input-group-text"},ie=["name","onChange","checked"],ue={class:"ml-2"},ne={key:0,class:"input__error error"},re={__name:"CheckboxComponent",props:{name:{type:String,required:!0},options:{type:Array,required:!0},modelValue:{},rules:{},errors:{type:Array}},emits:["update:modelValue"],setup(c,{emit:f}){const n=c;function h(y,p){y?n.modelValue.includes(p)||f("update:modelValue",[...n.modelValue,p]):n.modelValue.includes(p)&&f("update:modelValue",[...n.modelValue.filter(e=>e!==p)])}const{errorMessage:b,value:a}=T(()=>n.name,n.rules);return(y,p)=>(u(),r("div",ae,[(u(!0),r(I,null,M(c.options,e=>(u(),r("div",se,[t("div",te,[t("div",oe,[t("label",null,[t("input",{type:"checkbox",name:c.name,onChange:k=>h(k.target.checked,e.value),checked:c.modelValue.includes(e.value),"aria-label":"Checkbox for following text input"},null,40,ie),t("span",ue,N(e.label),1)])])])]))),256)),V(b)?(u(),r("span",ne,N(V(b)),1)):R("",!0)]))}},de={key:0,class:"overlay overlay-page"},me=t("i",{class:"fas fa-2x fa-sync-alt fa-spin"},null,-1),pe=[me],ce={class:"d-flex mb-4"},fe=t("div",{class:"input__label-text"},"Головна картинка",-1),ve={class:"mb-4"},_e=t("div",{class:"mb-2"},[t("div",{class:"input__label-text"},"Галерея картинок"),t("div",{class:"input__label-text"},"Размер: 1000х190")],-1),ge={type:"button",class:"btn btn-info mb-4"},Ve={key:0,class:"d-flex flex-wrap"},be={class:"d-flex mb-4"},ye=t("div",{class:"mr-4"},"Тип фільму",-1),he={class:"d-flex"},ke={class:"d-flex mb-4"},xe=t("div",{class:"mr-4"},"Показ фільму",-1),we={class:"d-flex"},$e={class:"seo-block"},Ie=t("h4",{class:"text-center mb-4"},"Seo блок",-1),Ue={type:"submit",class:"btn btn-success"},Ae={key:0,class:"spinner-border spinner-border-sm",role:"status"},qe=t("span",{class:"sr-only"},"Loading...",-1),De=[qe],Ne={key:1},je={__name:"AdminFilmsPageView",setup(c){const f=K(),n=$(!1),h="ua",b="ru",a=$(null),y=[{label:"3D",value:"3D"},{label:"2D",value:"2D"},{label:"IMAX",value:"IMAX"}],p=[{label:"В прокаті",value:"isShow"},{label:"Скоро вийде",value:"showSoon"}],e=$({id:E(),type:[],status:null,ua:{name:"",description:"",poster:{},images:[],trailer:"",seo:{url:"",title:"",keywords:"",description:""}},ru:{name:"",description:"",poster:{},images:[],trailer:"",seo:{url:"",title:"",keywords:"",description:""}}});function k(d){if(d.target.files.length)for(let l=0;l<d.target.files.length;l++)e.value[a.value].images.push({fileId:E(),file:d.target.files[l]})}function B(d){e.value[a.value].images.splice(d,1)}function G(){e.value[a.value].poster={}}const x=z();async function j(){if(J()){n.value=!0;let l={id:e.value.id,type:e.value.type,status:e.value.status};for(let m in e.value)if(m===h||m===b){let v=[];const o=e.value[m];for(let w=0;w<o.images.length;w++){let _=o.images[w];v.push({fileId:_.fileId,file:await C(_.fileId,`films/${e.value.id}`)?_.file:await F(`films/${e.value.id}/${_.fileId}`,_.file)})}let U=o.poster;Object.keys(o.poster).length&&(U={fileId:o.poster.fileId,file:await C(o.poster.fileId,`films/${e.value.id}`)?o.poster.file:await F(`films/${e.value.id}/${o.poster.fileId}`,o.poster.file)}),l={...l,[m]:{name:o.name,description:o.description,poster:U,images:v,trailer:o.trailer,seo:{url:o.seo.url,title:o.seo.title,keywords:o.seo.keywords,description:o.seo.description}}}}const s=S(L,"films",e.value.id);x.params.id?await ee(s,l):await le(s,l),n.value=!1}}return H(async()=>{if(a.value=A[0].value,x.params.id){const d=S(L,"films",x.params.id),l=await Z(d);l.exists()&&(e.value=l.data())}else e.value.status=p[0].value;f.setLoading(!1)}),(d,l)=>V(f).isLoading?(u(),r("div",de,pe)):(u(),r(I,{key:1},[i(P,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=s=>a.value=s),options:V(A),class:"mb-4"},null,8,["modelValue","options"]),i(V(O),{onSubmit:j},{default:Q(()=>[i(g,{modelValue:e.value[a.value].name,"onUpdate:modelValue":l[1]||(l[1]=s=>e.value[a.value].name=s),name:"film-name",label:"Назва фільму",rules:"required",class:"col-3 mb-4"},null,8,["modelValue"]),i(q,{modelValue:e.value[a.value].description,"onUpdate:modelValue":l[2]||(l[2]=s=>e.value[a.value].description=s),name:"film-description",label:"Опис",rules:"required",class:"mb-4"},null,8,["modelValue"]),t("div",ce,[fe,i(D,{modelValue:e.value[a.value].poster,"onUpdate:modelValue":l[3]||(l[3]=s=>e.value[a.value].poster=s),onDeleteImage:G,name:"film-poster","has-text":!1,"has-url":!1,class:"col-2"},null,8,["modelValue"])]),t("div",ve,[_e,t("label",ge,[W(" Додати фото "),t("input",{onChange:k,type:"file",multiple:"",accept:"image/png, image/jpeg, image/jpg, image/webp, image/svg",class:"image-upload__input"},null,32)]),e.value[a.value].images.length?(u(),r("div",Ve,[(u(!0),r(I,null,M(e.value[a.value].images,(s,m)=>(u(),Y(D,{modelValue:e.value[a.value].images[m],"onUpdate:modelValue":v=>e.value[a.value].images[m]=v,onDeleteImage:v=>B(m),name:"film-image","has-text":!1,"has-url":!1,class:"col-2 mb-2",key:`film-image-${m}`},null,8,["modelValue","onUpdate:modelValue","onDeleteImage"]))),128))])):R("",!0)]),i(g,{modelValue:e.value[a.value].trailer,"onUpdate:modelValue":l[4]||(l[4]=s=>e.value[a.value].trailer=s),name:"film-trailer",label:"Посилання на трейлер",rules:"required",class:"mb-4"},null,8,["modelValue"]),t("div",be,[ye,t("div",he,[i(re,{modelValue:e.value.type,"onUpdate:modelValue":l[5]||(l[5]=s=>e.value.type=s),options:y,name:"film-type",rules:"required"},null,8,["modelValue"])])]),t("div",ke,[xe,t("div",we,[i(X,{modelValue:e.value.status,"onUpdate:modelValue":l[6]||(l[6]=s=>e.value.status=s),options:p,name:"film-type",rules:"required"},null,8,["modelValue"])])]),t("div",$e,[Ie,i(g,{modelValue:e.value[a.value].seo.url,"onUpdate:modelValue":l[7]||(l[7]=s=>e.value[a.value].seo.url=s),name:"seo-url",label:"URL",rules:"required",class:"mb-4"},null,8,["modelValue"]),i(g,{modelValue:e.value[a.value].seo.title,"onUpdate:modelValue":l[8]||(l[8]=s=>e.value[a.value].seo.title=s),name:"seo-title",label:"Title",rules:"required",class:"mb-4"},null,8,["modelValue"]),i(g,{modelValue:e.value[a.value].seo.keywords,"onUpdate:modelValue":l[9]||(l[9]=s=>e.value[a.value].seo.keywords=s),name:"seo-keywords",label:"Keywords",rules:"required",class:"mb-4"},null,8,["modelValue"]),i(q,{modelValue:e.value[a.value].seo.description,"onUpdate:modelValue":l[10]||(l[10]=s=>e.value[a.value].seo.description=s),name:"seo-description",label:"Description",rules:"required",class:"mb-4"},null,8,["modelValue"])]),t("button",Ue,[n.value?(u(),r("div",Ae,De)):(u(),r("span",Ne,"Зберегти"))])]),_:1})],64))}};export{je as default};
