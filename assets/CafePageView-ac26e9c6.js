import{r as c,c as x,x as G,s as O,l as P,d as p,o as i,e as m,b as l,w as z,v as H,h as u,i as J,F as y,j as Q,k as D,a as W,f as M,t as g}from"./index-5ccc9495.js";import{_ as X}from"./TabsComponent-2b439d40.js";import{a as Y,_ as v,F as Z}from"./InputComponent-926cc09d.js";import{_ as C}from"./TextareaComponent-3fceddef.js";import{_ as S}from"./ImageUpload-734539ec.js";import{l as f}from"./languages-14535d94.js";import{V as ee,r as ae,d as le,b as te,a as se}from"./index-2c7431f0.js";import{p as oe,a as ne}from"./preparedDataToFirebase-469b79a8.js";import{a as ue}from"./queriesFirestore-d3fa99f6.js";import{u as ie}from"./general-e95eafb2.js";import{v as me}from"./v4-a960c1f4.js";import"./vee-validate-6f28d402.js";import"./index-dbcece3d.js";const re={key:0,class:"overlay overlay-page"},de=l("i",{class:"fas fa-2x fa-sync-alt fa-spin"},null,-1),ce=[de],ve={class:"d-flex"},pe={class:"custom-control custom-switch custom-switch-lg admin__switch mr-4"},fe=l("label",{class:"custom-control-label",for:"customSwitch1"},null,-1),be={class:"d-flex mb-4"},_e=l("div",{class:"input__label-text"},"Головна картинка",-1),ge={class:"mb-4"},Ve=l("div",{class:"mb-2"},[l("div",{class:"input__label-text"},"Галерея картинок"),l("div",{class:"input__label-text"},"Размер: 1000х190")],-1),he={type:"button",class:"btn btn-info mb-4"},ye={key:0,class:"d-flex flex-wrap"},we=l("h4",{class:"text-center mb-4"},"Меню",-1),ke={key:0,class:"table"},Ue=l("thead",null,[l("tr",null,[l("th",{scope:"col"},"#"),l("th",{scope:"col"},"Назва"),l("th",{scope:"col"},"Ціна"),l("th",{scope:"col"}),l("th",{scope:"col"})])],-1),xe={scope:"row"},De=["onClick"],Me=l("i",{class:"fa-solid fa-pen"},null,-1),Ce=[Me],Se=["onClick"],$e=l("i",{class:"fa-solid fa-trash-can"},null,-1),Be=[$e],Te={class:"row"},Ie={class:"seo-block"},Fe=l("h4",{class:"text-center mb-4"},"Seo блок",-1),qe={type:"submit",class:"btn btn-success"},Le={key:0,class:"spinner-border spinner-border-sm",role:"status"},Ne=l("span",{class:"sr-only"},"Loading...",-1),Ae=[Ne],Ee={key:1},ea={__name:"CafePageView",setup(Ke){const w=ie(),s=c(null),V=c(!1),e=c({id:"cafe",created:null,active:!0,canDelete:!1,ua:{name:"",description:"",banner:{},images:[],menu:[],seo:{url:"",title:"",keywords:"",description:""}},ru:{name:"",description:"",banner:{},images:[],menu:[],seo:{url:"",title:"",keywords:"",description:""}}});function $(o){if(o.target.files.length)for(let a=0;a<o.target.files.length;a++)e.value[s.value].images.push({fileId:me(),file:o.target.files[a]})}function B(){e.value[s.value].banner={}}function T(o){e.value[s.value].images.splice(o,1)}const I="edit",b="add",r=c({name:"",price:""}),_=c(b);function F(){for(let o in e.value)f.some(a=>a.value===o)&&(o===s.value?e.value[o].menu.push(r.value):e.value[o].menu.push({name:"",price:"",active:!0}));k()}const h=c(null);function q(o){_.value=I,h.value=o,r.value=e.value[s.value].menu[o]}function L(){e.value[s.value].menu[h]=r.value,k(),h.value=null,_.value=b}function N(o){for(let a in e.value)f.some(t=>t.value===a)&&e.value[a].menu.splice(o,1)}function k(){r.value={name:"",price:"",active:!0}}const A=x(()=>_.value===b?"Додати страву":"Редагувати"),E=x(()=>_.value===b?F:L),K=G(),U=O();async function R(){if(Y()){V.value=!0;let a={id:e.value.id,active:e.value.active,canDelete:e.value.canDelete};for(let n in e.value)if(f.some(d=>d.value===n)){const d=await oe(e.value[n].images,`pages/${e.value.id}`),j=await ne(e.value[n].banner,`pages/${e.value.id}`);a={...a,created:U.params.id?e.value.created:ee(),[n]:{...e.value[n],images:d,banner:j}}}const t=ae(le,"pages",e.value.id);U.params.id?await te(t,a):await se(t,a),await K.replace({name:"admin-pages"}),V.value=!1}}return P(async()=>{s.value=f[0].value,e.value=await ue("pages",e.value.id),w.isLoading=!1}),(o,a)=>p(w).isLoading?(i(),m("div",re,ce)):(i(),m(y,{key:1},[l("div",ve,[l("div",pe,[z(l("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>e.value.active=t),type:"checkbox",class:"custom-control-input",id:"customSwitch1"},null,512),[[H,e.value.active]]),fe]),u(X,{modelValue:s.value,"onUpdate:modelValue":a[1]||(a[1]=t=>s.value=t),options:p(f),class:"mb-4"},null,8,["modelValue","options"])]),u(p(Z),{onSubmit:R},{default:J(()=>[u(v,{modelValue:e.value[s.value].name,"onUpdate:modelValue":a[2]||(a[2]=t=>e.value[s.value].name=t),name:"item-name",label:"Назва",rules:"required",class:"col-6 mb-4"},null,8,["modelValue"]),u(C,{modelValue:e.value[s.value].description,"onUpdate:modelValue":a[3]||(a[3]=t=>e.value[s.value].description=t),name:"item-description",label:"Опис",rules:"required",class:"mb-4"},null,8,["modelValue"]),l("div",be,[_e,u(S,{modelValue:e.value[s.value].banner,"onUpdate:modelValue":a[4]||(a[4]=t=>e.value[s.value].banner=t),onDeleteImage:B,name:"item-banner","has-text":!1,"has-url":!1,class:"col-2"},null,8,["modelValue"])]),l("div",ge,[Ve,l("label",he,[Q(" Додати фото "),l("input",{onChange:$,type:"file",multiple:"",accept:"image/png, image/jpeg, image/jpg, image/webp, image/svg",class:"image-upload__input"},null,32)]),e.value[s.value].images.length?(i(),m("div",ye,[(i(!0),m(y,null,D(o.imageItem[s.value].images,(t,n)=>(i(),W(S,{modelValue:t[s.value].images[n],"onUpdate:modelValue":d=>t[s.value].images[n]=d,onDeleteImage:d=>T(n),name:"item-image","has-text":!1,"has-url":!1,class:"col-2 mb-2",key:`item-image-${n}`},null,8,["modelValue","onUpdate:modelValue","onDeleteImage"]))),128))])):M("",!0)]),l("div",null,[we,e.value[s.value].menu.length?(i(),m("table",ke,[Ue,l("tbody",null,[(i(!0),m(y,null,D(e.value[s.value].menu,(t,n)=>(i(),m("tr",null,[l("th",xe,g(n+1),1),l("td",null,g(t.name),1),l("td",null,g(t.price),1),l("td",null,[l("button",{type:"button",onClick:d=>q(n)},Ce,8,De)]),l("td",null,[l("button",{onClick:d=>N(n),type:"button"},Be,8,Se)])]))),256))])])):M("",!0),l("div",Te,[u(v,{modelValue:r.value.name,"onUpdate:modelValue":a[5]||(a[5]=t=>r.value.name=t),name:"menu-meal-name",label:"Назва страви",class:"col-6 mb-4"},null,8,["modelValue"]),u(v,{modelValue:r.value.price,"onUpdate:modelValue":a[6]||(a[6]=t=>r.value.price=t),name:"menu-meal-price",type:"number",label:"Ціна",class:"col-6 mb-4"},null,8,["modelValue"])]),l("button",{onClick:a[7]||(a[7]=t=>p(E)()),type:"button",class:"btn btn-info mb-4"},g(p(A)),1)]),l("div",Ie,[Fe,u(v,{modelValue:e.value[s.value].seo.url,"onUpdate:modelValue":a[8]||(a[8]=t=>e.value[s.value].seo.url=t),name:"seo-url",label:"URL",rules:"required",class:"mb-4"},null,8,["modelValue"]),u(v,{modelValue:e.value[s.value].seo.title,"onUpdate:modelValue":a[9]||(a[9]=t=>e.value[s.value].seo.title=t),name:"seo-title",label:"Title",rules:"required",class:"mb-4"},null,8,["modelValue"]),u(v,{modelValue:e.value[s.value].seo.keywords,"onUpdate:modelValue":a[10]||(a[10]=t=>e.value[s.value].seo.keywords=t),name:"seo-keywords",label:"Keywords",rules:"required",class:"mb-4"},null,8,["modelValue"]),u(C,{modelValue:e.value[s.value].seo.description,"onUpdate:modelValue":a[11]||(a[11]=t=>e.value[s.value].seo.description=t),name:"seo-description",label:"Description",rules:"required",class:"mb-4"},null,8,["modelValue"])]),l("button",qe,[V.value?(i(),m("div",Le,Ae)):(i(),m("span",Ee,"Зберегти"))])]),_:1})],64))}};export{ea as default};
