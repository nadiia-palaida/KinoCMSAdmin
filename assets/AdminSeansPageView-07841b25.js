import{_ as u}from"./SelectComponent-090a3a34.js";import{a as D,_ as f,F as N}from"./InputComponent-926cc09d.js";import"./vee-validate-6f28d402.js";import{r as R,d as T,b as L,a as S}from"./index-2c7431f0.js";import{g as V,a as g}from"./queriesFirestore-d3fa99f6.js";import{r as t,c as _,x as $,s as z,l as E,z as w,o as m,a as h,i as M,d as r,h as n,f as P,b as F,e as q}from"./index-5ccc9495.js";import{v as j}from"./v4-a960c1f4.js";const G="ua";function b(y){return y.map(o=>({label:o[G].name,value:o.id}))}const H={type:"submit",class:"btn btn-success"},J={key:0,class:"spinner-border spinner-border-sm",role:"status"},K=F("span",{class:"sr-only"},"Loading...",-1),Q=[K],W={key:1},te={__name:"AdminSeansPageView",setup(y){const d=t([]),o=t([]),i=t([]),U=t({}),c=t([]),p=t(!1),k=_(()=>b(o.value)),B=_(()=>b(i.value)),O=_(()=>b(d.value)),e=t({id:j(),film_id:"",cinema_id:null,hall_id:null,seats:[],type:null,date:null,time:null,price:null});async function x(){const s=await A(e.value.film_id);return e.value.film_id&&s?c.value=s.type.map(a=>({label:a,value:a})):[]}async function A(s){const a=await g("films",s);return a||null}const C=$(),v=z();async function I(){if(D()){p.value=!0;const a=R(T,"seanses",e.value.id),l={...e.value};v.params.id?await L(a,l):await S(a,l),await C.replace({name:"admin-seanses",params:{id:U.value.id}}),p.value=!1}}return E(async()=>{d.value=await V("films"),i.value=await V("cinemas"),v.params.id?e.value=await g("seanses",v.params.id):i.value.length&&(e.value.cinema_id=i.value[0].id)}),w(()=>e.value.film_id,s=>{x()}),w(()=>e.value.cinema_id,async s=>{o.value=await V("halls",["cinema_id","==",e.value.cinema_id])}),(s,a)=>(m(),h(r(N),{onSubmit:I},{default:M(()=>[n(u,{modelValue:e.value.cinema_id,"onUpdate:modelValue":a[0]||(a[0]=l=>e.value.cinema_id=l),options:r(B),label:"Кінотеатр",rules:"required",name:"seans-cinema",class:"col-3"},null,8,["modelValue","options"]),n(u,{modelValue:e.value.hall_id,"onUpdate:modelValue":a[1]||(a[1]=l=>e.value.hall_id=l),options:r(k),label:"Зал",rules:"required",name:"seans-hall",class:"col-3"},null,8,["modelValue","options"]),n(u,{modelValue:e.value.film_id,"onUpdate:modelValue":a[2]||(a[2]=l=>e.value.film_id=l),options:r(O),label:"Фільм",rules:"required",name:"seans-film",class:"col-3"},null,8,["modelValue","options"]),c.value.length?(m(),h(u,{key:0,modelValue:e.value.type,"onUpdate:modelValue":a[3]||(a[3]=l=>e.value.type=l),options:c.value,rules:"required",name:"seans-type",label:"Тип фільму",class:"col-3 mb-4"},null,8,["modelValue","options"])):P("",!0),n(f,{modelValue:e.value.date,"onUpdate:modelValue":a[4]||(a[4]=l=>e.value.date=l),name:"seans-date",type:"date",label:"Дата",rules:"required",class:"col-2 mb-4"},null,8,["modelValue"]),n(f,{modelValue:e.value.time,"onUpdate:modelValue":a[5]||(a[5]=l=>e.value.time=l),name:"seans-time",type:"time",label:"Час",rules:"required",class:"col-2 mb-4"},null,8,["modelValue"]),n(f,{modelValue:e.value.price,"onUpdate:modelValue":a[6]||(a[6]=l=>e.value.price=l),name:"seans-price",type:"price",label:"Ціна",rules:"required|numeric",class:"col-2 mb-4"},null,8,["modelValue"]),F("button",H,[p.value?(m(),q("div",J,Q)):(m(),q("span",W,"Зберегти"))])]),_:1}))}};export{te as default};
