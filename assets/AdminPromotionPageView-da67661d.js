import{r as v,x as B,s as $,l as D,d as b,o as u,e as m,b as s,w as F,v as L,h as t,i as C,F as g,j as S,k as N,a as R,f as T}from"./index-5ccc9495.js";import{_ as j}from"./TabsComponent-2b439d40.js";import{a as G,_ as d,F as A}from"./InputComponent-926cc09d.js";import{_ as V}from"./TextareaComponent-3fceddef.js";import{_ as y}from"./ImageUpload-734539ec.js";import{l as f}from"./languages-14535d94.js";import{V as K,r as M,d as P,b as E,a as O}from"./index-2c7431f0.js";import{a as z}from"./queriesFirestore-d3fa99f6.js";import{p as H,a as J}from"./preparedDataToFirebase-469b79a8.js";import{u as Q}from"./general-e95eafb2.js";import{v as w}from"./v4-a960c1f4.js";import"./vee-validate-6f28d402.js";import"./index-dbcece3d.js";const W={key:0,class:"overlay overlay-page"},X=s("i",{class:"fas fa-2x fa-sync-alt fa-spin"},null,-1),Y=[X],Z={class:"d-flex"},ee={class:"custom-control custom-switch custom-switch-lg admin__switch mr-4"},ae=s("label",{class:"custom-control-label",for:"customSwitch1"},null,-1),le={class:"row"},oe={class:"d-flex mb-4"},se=s("div",{class:"input__label-text"},"Головна картинка",-1),te={class:"mb-4"},ie=s("div",{class:"mb-2"},[s("div",{class:"input__label-text"},"Галерея картинок"),s("div",{class:"input__label-text"},"Размер: 1000х190")],-1),ne={type:"button",class:"btn btn-info mb-4"},ue={key:0,class:"d-flex flex-wrap"},re={class:"seo-block"},me=s("h4",{class:"text-center mb-4"},"Seo блок",-1),de={type:"submit",class:"btn btn-success"},ce={key:0,class:"spinner-border spinner-border-sm",role:"status"},pe=s("span",{class:"sr-only"},"Loading...",-1),ve=[pe],be={key:1},De={__name:"AdminPromotionPageView",setup(fe){const _=Q(),l=v(null),p=v(!1),e=v({id:w(),created:null,active:!0,publication_date:null,ua:{name:"",description:"",banner:{},images:[],video_link:"",seo:{url:"",title:"",keywords:"",description:""}},ru:{name:"",description:"",banner:{},images:[],video_link:"",seo:{url:"",title:"",keywords:"",description:""}}});function k(n){if(n.target.files.length)for(let a=0;a<n.target.files.length;a++)e.value[l.value].images.push({fileId:w(),file:n.target.files[a]})}function h(){e.value[l.value].banner={}}function x(n){e.value[l.value].images.splice(n,1)}const U=B(),c=$();async function I(){if(G()){p.value=!0;let a={id:e.value.id,active:e.value.active,publication_date:e.value.publication_date};for(let i in e.value)if(f.some(r=>r.value===i)){const r=await H(e.value[i].images,`promotions/${e.value.id}`),q=await J(e.value[i].banner,`promotions/${e.value.id}`);a={...a,created:c.params.id?e.value.created:K(),[i]:{...e.value[i],images:r,banner:q}}}const o=M(P,"promotions",e.value.id);c.params.id?await E(o,a):await O(o,a),await U.replace({name:"admin-promotions"}),p.value=!1}}return D(async()=>{l.value=f[0].value,c.params.id&&(e.value=await z("promotions",c.params.id)),_.isLoading=!1}),(n,a)=>b(_).isLoading?(u(),m("div",W,Y)):(u(),m(g,{key:1},[s("div",Z,[s("div",ee,[F(s("input",{"onUpdate:modelValue":a[0]||(a[0]=o=>e.value.active=o),type:"checkbox",class:"custom-control-input",id:"customSwitch1"},null,512),[[L,e.value.active]]),ae]),t(j,{modelValue:l.value,"onUpdate:modelValue":a[1]||(a[1]=o=>l.value=o),options:b(f),class:"mb-4"},null,8,["modelValue","options"])]),t(b(A),{onSubmit:I},{default:C(()=>[s("div",le,[t(d,{modelValue:e.value[l.value].name,"onUpdate:modelValue":a[2]||(a[2]=o=>e.value[l.value].name=o),name:"promotion-name",label:"Назва акції",rules:"required",class:"col-6 mb-4"},null,8,["modelValue"]),t(d,{modelValue:e.value.publication_date,"onUpdate:modelValue":a[3]||(a[3]=o=>e.value.publication_date=o),name:"promotion-publication-date",type:"date",label:"Дата публікації",rules:"required",class:"col-6 mb-4"},null,8,["modelValue"])]),t(V,{modelValue:e.value[l.value].description,"onUpdate:modelValue":a[4]||(a[4]=o=>e.value[l.value].description=o),name:"promotion-description",label:"Опис",rules:"required",class:"mb-4"},null,8,["modelValue"]),s("div",oe,[se,t(y,{modelValue:e.value[l.value].banner,"onUpdate:modelValue":a[5]||(a[5]=o=>e.value[l.value].banner=o),onDeleteImage:h,name:"promotion-banner","has-text":!1,"has-url":!1,class:"col-2"},null,8,["modelValue"])]),s("div",te,[ie,s("label",ne,[S(" Додати фото "),s("input",{onChange:k,type:"file",multiple:"",accept:"image/png, image/jpeg, image/jpg, image/webp, image/svg",class:"image-upload__input"},null,32)]),e.value[l.value].images.length?(u(),m("div",ue,[(u(!0),m(g,null,N(e.value[l.value].images,(o,i)=>(u(),R(y,{modelValue:e.value[l.value].images[i],"onUpdate:modelValue":r=>e.value[l.value].images[i]=r,onDeleteImage:r=>x(i),name:"promotion-image","has-text":!1,"has-url":!1,class:"col-2 mb-2",key:`promotion-image-${i}`},null,8,["modelValue","onUpdate:modelValue","onDeleteImage"]))),128))])):T("",!0)]),t(d,{modelValue:e.value[l.value].video_link,"onUpdate:modelValue":a[6]||(a[6]=o=>e.value[l.value].video_link=o),name:"promotion-video",label:"Посилання на відео",rules:"required|url",class:"col-6 mb-4"},null,8,["modelValue"]),s("div",re,[me,t(d,{modelValue:e.value[l.value].seo.url,"onUpdate:modelValue":a[7]||(a[7]=o=>e.value[l.value].seo.url=o),name:"seo-url",label:"URL",rules:"required",class:"mb-4"},null,8,["modelValue"]),t(d,{modelValue:e.value[l.value].seo.title,"onUpdate:modelValue":a[8]||(a[8]=o=>e.value[l.value].seo.title=o),name:"seo-title",label:"Title",rules:"required",class:"mb-4"},null,8,["modelValue"]),t(d,{modelValue:e.value[l.value].seo.keywords,"onUpdate:modelValue":a[9]||(a[9]=o=>e.value[l.value].seo.keywords=o),name:"seo-keywords",label:"Keywords",rules:"required",class:"mb-4"},null,8,["modelValue"]),t(V,{modelValue:e.value[l.value].seo.description,"onUpdate:modelValue":a[10]||(a[10]=o=>e.value[l.value].seo.description=o),name:"seo-description",label:"Description",rules:"required",class:"mb-4"},null,8,["modelValue"])]),s("button",de,[p.value?(u(),m("div",ce,ve)):(u(),m("span",be,"Зберегти"))])]),_:1})],64))}};export{De as default};
