import{r as p,c as A,g as L,o as d,e as b,t as U,f as k,b as t,w as I,v as D,h as g,i as x,j as P,d as y,F as V,k as M,a as R,l as C,m as w,n as F,p as j}from"./index-5ccc9495.js";import{F as O}from"./InputComponent-926cc09d.js";import{_ as S}from"./ImageUpload-734539ec.js";import{_ as q}from"./SelectComponent-090a3a34.js";import{f as T,u as E,t as G,s as K,a as Y,r as z,d as $}from"./index-2c7431f0.js";import{v as B}from"./v4-a960c1f4.js";import{_ as H}from"./RadioComponent-1176aee6.js";import{u as W}from"./general-e95eafb2.js";import"./vee-validate-6f28d402.js";import"./index-dbcece3d.js";const J={class:"admin__section"},Q={key:0,class:"text-center mb-4"},X={class:"admin__block shadow-lg rounded p-3"},Z={class:"admin__switch-wrap"},ee={class:"custom-control custom-switch custom-switch-lg admin__switch ml-auto"},ae=t("label",{class:"custom-control-label",for:"customSwitch1"},null,-1),se=t("div",{class:"mb-4"},"Размер: 1000х190",-1),ne={type:"button",class:"btn btn-info mb-4"},te={class:"admin__form-images mb-2"},le={type:"submit",class:"btn btn-success"},oe={key:0,class:"spinner-border spinner-border-sm",role:"status"},ie=t("span",{class:"sr-only"},"Loading...",-1),re=[ie],ue={key:1},N={__name:"BannersMultiple",props:{name:{type:String},bannersInfo:{type:Object,required:!0},loading:{type:Boolean,default:!1},title:{type:String},firebasePathName:{type:String,required:!0},hasText:{type:Boolean,default:!0}},emits:["saveChanges"],setup(c,{emit:m}){const o=c,f=[{label:"5",value:5},{label:"10",value:10},{label:"15",value:15},{label:"20",value:20},{label:"30",value:30}],n=p({active:!0,items:[],speed:0}),_=A(()=>n.value.items);function u(l,e){n.value.items[e]?n.value.items[e]=l:n.value.items.push(l)}function i(l){if(l.target.files.length)for(let e=0;e<l.target.files.length;e++)n.value.items.push({id:B(),fileId:B(),file:l.target.files[e],url:"",text:""})}function r(l){n.value.items.splice(l,1)}async function v(){let l=[];for(let a=0;a<n.value.items.length;a++){let s=n.value.items[a];l.push({id:s.id,fileId:s.fileId,file:await T(s.fileId,o.firebasePathName)?s.file:await E(`${o.firebasePathName}/${s.fileId}`,s.file),url:s.url,text:s.text})}n.value.items=l;const e={active:n.value.active,items:l,speed:n.value.speed};m("saveChanges",e)}return L(()=>{n.value=o.bannersInfo,n.value.speed||(n.value.speed=f[0].value)}),(l,e)=>(d(),b("section",J,[c.title?(d(),b("h2",Q,U(c.title),1)):k("",!0),t("div",X,[t("div",Z,[t("div",ee,[I(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>n.value.active=a),type:"checkbox",class:"custom-control-input",id:"customSwitch1"},null,512),[[D,n.value.active]]),ae])]),se,g(y(O),{onSubmit:v},{default:x(()=>[t("label",ne,[P(" Додати фото "),t("input",{onChange:i,type:"file",multiple:"",accept:"image/png, image/jpeg, image/jpg, image/webp, image/svg",class:"image-upload__input"},null,32)]),t("div",te,[y(_)?(d(!0),b(V,{key:0},M(y(_),(a,s)=>(d(),R(S,{modelValue:a,hasText:c.hasText,name:`${c.name}-banner-${s}`,"onUpdate:modelValue":h=>u(h,s),onDeleteImage:h=>r(s),class:"mr-4 mb-4",key:`top-banner-image-${a.id}`,rules:"required"},null,8,["modelValue","hasText","name","onUpdate:modelValue","onDeleteImage"]))),128)):k("",!0)]),g(q,{modelValue:n.value.speed,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value.speed=a),options:f,label:"Швидкість каруселі",name:"top-banners-carousel-speed",class:"col-3"},null,8,["modelValue"]),t("button",le,[c.loading?(d(),b("div",oe,re)):(d(),b("span",ue,"Зберегти"))])]),_:1})])]))}},de={class:"admin__section"},ce=t("h2",{class:"text-center mb-4"},"Банер на фоні",-1),me={class:"admin__block shadow-lg rounded p-3"},fe=t("div",{class:"mb-4"},"Размер: 2000х3000",-1),ve={class:"d-flex"},pe=t("span",{class:"mr-2"},"Вибрати колір",-1),be={type:"submit",class:"btn btn-success"},_e={key:0,class:"spinner-border spinner-border-sm",role:"status"},he=t("span",{class:"sr-only"},"Loading...",-1),ge=[he],ye={key:1},Ie={__name:"BannerBackground",props:{bannersInfo:{type:Object,required:!0},loading:{type:Boolean,default:!1},firebasePathName:{type:String,required:!0}},emits:["saveChanges"],setup(c,{emit:m}){const o=c,f="photo",n="color",_=[{label:" Фото на фон",value:"photo"},{label:"Просто фон",value:"color"}],u=p(null),i=p({file:"",fileId:""}),r=p(null);function v(){console.log("delete banner"),i.value={file:"",fileId:""}}async function l(){let e=null;r.value===f?(e=i.value,e.file=await T(i.value.fileId,o.firebasePathName)?i.value.file:await E(`${o.firebasePathName}/${i.value.fileId}`,i.value.file)):e=u.value;const a={type:r.value,banner:e};m("saveChanges",a)}return C(()=>{o.bannersInfo.type?(r.value=o.bannersInfo.type,o.bannersInfo.type===f?o.bannersInfo.banner&&o.bannersInfo.banner.hasOwnProperty("file")&&(i.value=o.bannersInfo.banner):o.bannersInfo.type===n&&(u.value=o.bannersInfo.banner)):r.value=_[0].value}),(e,a)=>(d(),b("div",de,[ce,t("div",me,[fe,g(y(O),{onSubmit:l},{default:x(()=>[t("div",ve,[g(H,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=s=>r.value=s),options:_,name:"background-banner-radio",class:"mr-4"},null,8,["modelValue"]),I(g(S,{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=s=>i.value=s),hasUrl:!1,onDeleteImage:v,hasText:!1,name:"banner-background-image",class:"col-2"},null,8,["modelValue"]),[[w,r.value===f]]),I(t("div",null,[t("label",null,[pe,I(t("input",{type:"color","onUpdate:modelValue":a[2]||(a[2]=s=>u.value=s)},null,512),[[F,u.value]])]),t("div",{class:"choose-color",style:j(`background: ${u.value}`)},null,4)],512),[[w,r.value===n]])]),t("button",be,[c.loading?(d(),b("div",_e,ge)):(d(),b("span",ye,"Зберегти"))])]),_:1})])]))}},ke={key:0,class:"overlay overlay-page"},we=t("i",{class:"fas fa-2x fa-sync-alt fa-spin"},null,-1),$e=[we],Le={__name:"AdminBannersView",setup(c){const m=p({}),o=W();p(!0);const f=p(!1),n=p(!1),_=p(!1),u=p({topBanners:[],newsBanners:[],backgroundBanner:[]}),i="topBanners",r="newsBanners",v="backgroundBanner";async function l(e,a){switch(a){case i:f.value=!0;break;case r:n.value=!0;break;case v:_.value=!0;break}e.items&&e.items.length?e.items.map(h=>h.fileId):e.banner.fileId&&(u.value[a]=u.value[a].filter(h=>e.banner.fileId!==h));let s=[];switch(s.push(await Y(z($,"banners",a),e)),await Promise.all(s),e.items&&e.items.length?u.value[a]=e.items.map(h=>h.fileId):e.banner.fileId&&u.value[a].push(e.banner.fileId),a){case i:f.value=!1;break;case r:n.value=!1;break;case v:_.value=!1;break}}return C(async()=>{o.setLoading(!0),m.value=await G(K($,"banners")),m.value.forEach(e=>{m.value[e.id]=e.data(),e.data().items?u.value[e.id]=e.data().items.map(a=>a.fileId):e.data().banner.fileId&&u.value[e.id].push(e.data().banner.fileId)}),o.setLoading(!1)}),(e,a)=>y(o).isLoading?(d(),b("div",ke,$e)):(d(),b(V,{key:1},[g(N,{"banners-info":m.value[i],name:i,onSaveChanges:a[0]||(a[0]=s=>l(s,i)),firebasePathName:i,loading:f.value,title:"На головній верх",class:"mb-5"},null,8,["banners-info","loading"]),g(Ie,{"banners-info":m.value[v],firebasePathName:v,name:v,onSaveChanges:a[1]||(a[1]=s=>l(s,v)),class:"mb-5"},null,8,["banners-info"]),g(N,{"banners-info":m.value[r],hasText:!1,onSaveChanges:a[2]||(a[2]=s=>l(s,r)),firebasePathName:r,name:r,loading:n.value,title:"На головній новини, акції",class:"mb-5"},null,8,["banners-info","loading"])],64))}};export{Le as default};
