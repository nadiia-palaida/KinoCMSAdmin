import{_ as R}from"./RadioComponent-1176aee6.js";import{_ as O}from"./TextareaComponent-3fceddef.js";import{r as _,l as j,d as A,o as l,e as a,b as s,h as V,C as Y,F as g,k as N,t as u,f as p,c as B,a as I,U as D}from"./index-5ccc9495.js";import{_ as T}from"./InputComponent-926cc09d.js";import{u as L}from"./general-e95eafb2.js";import{h as H}from"./moment-fbc5633a.js";import{s as G,d as K}from"./index-2c7431f0.js";import{b as W,n as q,p as z,s as J,g as Q}from"./queriesFirestore-d3fa99f6.js";import{c as X}from"./cities-aae58f0e.js";const Z={key:0,class:"overlay overlay-page"},ss=s("i",{class:"fas fa-2x fa-sync-alt fa-spin"},null,-1),es=[ss],ts=s("div",{class:"d-flex justify-content-center w-100 mb-4"},[s("h2",{class:"text-center"},"Користувачі")],-1),ns={class:"d-flex justify-content-end mb-4"},ls={key:0,class:"table"},as=s("thead",null,[s("tr",null,[s("th"),s("th",{scope:"col"},"ID"),s("th",{scope:"col"},"Дата реєстрації"),s("th",{scope:"col"},"День народження"),s("th",{scope:"col"},"Email"),s("th",{scope:"col"},"Телефон"),s("th",{scope:"col"},"ПІБ"),s("th",{scope:"col"},"Псевдонім"),s("th",{scope:"col"},"Місто")])],-1),os=["onChange","checked","name"],cs={__name:"UsersChoose",props:{usersArr:{type:Array,default:[]}},emits:["send"],setup(P,{emit:S}){const y=P,h=L(),c=_({items:[]}),r=_([]),d=_(""),f=_("");function m(n,t){n?r.value.push(t):v(t)&&(r.value=r.value.filter(e=>e!==t))}function v(n){return r.value.some(t=>t===n)}function k(n){return`${c.value.items[n].firstName} ${c.value.items[n].lastName}`}function U(n){let t=null;return typeof n=="object"&&(t=X.find(e=>e.value===n.value)),t?t.label:n}function C(n){return n?H(n.toDate()).format("DD.MM.YYYY"):null}function i(){S("send",r.value)}const o=5,x="id",b=G(K,"users");async function w(){c.value.items=await q(b,x,o,"nameArr",f.value)}async function $(){c.value.items=await z(b,x,o,"nameArr",f.value)}async function E(){f.value=d.value,c.value.items=await J(b,"nameArr",f.value,"id",5)}return j(async()=>{c.value.items=await W(b,x,o),r.value=y.usersArr,h.isLoading=!1}),(n,t)=>A(h).isLoading?(l(),a("div",Z,es)):(l(),a(g,{key:1},[ts,s("div",ns,[V(T,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),onKeyup:Y(E,["enter"]),name:"users-search",placeholder:"Пошук",class:"col-4"},null,8,["modelValue","onKeyup"]),s("div",null,[s("button",{onClick:E,class:"btn btn-info"},"Пошук")])]),c.value.items.length?(l(),a("table",ls,[as,s("tbody",null,[(l(!0),a(g,null,N(c.value.items,(e,M)=>(l(),a("tr",null,[s("td",null,[s("input",{type:"checkbox",onChange:F=>m(F.target.checked,e.id),checked:v(e.id),name:`checkbox-user-subscribe-${e.id}`},null,40,os)]),s("td",null,u(e.id),1),s("td",null,u(C(e.created)),1),s("td",null,u(e.birthDate),1),s("td",null,u(e.email),1),s("td",null,u(e.phone),1),s("td",null,u(k(M)),1),s("td",null,u(e.nick),1),s("td",null,u(U(e.city)),1)]))),256))])])):p("",!0),s("nav",{"aria-label":"Page navigation example"},[s("ul",{class:"pagination"},[s("li",{class:"page-item"},[s("button",{onClick:$,type:"button",class:"page-link"},"Previous")]),s("li",{class:"page-item"},[s("button",{onClick:w,type:"button",class:"page-link"},"Next")])])]),s("div",{class:"d-flex justify-content-center"},[s("button",{onClick:i,class:"btn btn-success"},"Відправити вибрані")])],64))}},is={key:0,class:"overlay overlay-page"},us=s("i",{class:"fas fa-2x fa-sync-alt fa-spin"},null,-1),rs=[us],ds={key:0},vs={class:"border rounded p-3 mb-4"},_s=s("div",{class:"d-flex justify-content-center w-100"},[s("h2",{class:"text-center"},"SMS")],-1),fs={key:0,class:"d-flex"},ms={class:"row mb-4"},ps={class:"col-8"},hs={class:"d-flex"},bs=s("div",{class:"mr-4"},"Вибрати користувачів яким розсилати смс",-1),ys={class:"col-4"},xs={class:"row"},gs={class:"col-7"},Ss={class:"text-right"},ks=D('<div class="col-3 offset-1"><div>К-сть SMS: <span class="text-info">173 629</span></div><div class="d-flex justify-content-between"><div>Розсилка виконана на: <span class="text-info">45%</span></div><div><span class="text-info">20 000</span></div></div></div>',1),Us=s("div",{class:"d-flex justify-content-center mt-4"},[s("button",{class:"btn btn-success"},"Почати розсилку")],-1),Cs={class:"border rounded p-3"},Es=s("div",{class:"d-flex justify-content-center w-100"},[s("h2",{class:"text-center"},"E-mail")],-1),Vs={key:0,class:"d-flex"},ws={class:"row mb-4"},$s={class:"col-8"},As={class:"d-flex"},Ns=s("div",{class:"mr-4"},"Вибрати користувачів яким розсилати email",-1),Ps={class:"col-4"},Rs={class:"row"},js={class:"col-7"},Ds={class:"mb-3"},Ls=s("span",{class:"mr-3"},"Шаблон используемый в текущей рассылке:",-1),Ms={class:"text-info"},Fs=D('<div class="d-flex"><div class="mr-4">К-сть email: <span class="text-info">173 629</span></div><div class="d-flex justify-content-between"><div>Розсилка виконана на: <span class="text-info">45%</span></div></div></div>',1),Os=s("div",{class:"col-3 offset-1"},null,-1),Ys=s("div",{class:"d-flex justify-content-center mt-4"},[s("button",{class:"btn btn-success"},"Почати розсилку")],-1),Js={__name:"AdminSubscribeView",setup(P){const S=L(),y="all",h="some",c="page",r="users",d="sms",f="email",m=_(c),v=_(d),k=[{label:"Всі користувачі",value:y},{label:"Вибірково",value:h}];let U=[];function C(n){const t=U.find(e=>e.id===n);return`${t.firstName} ${t.lastName}`}const i=_({users:[],typeUsers:y,text:""}),o=_({users:[],typeUsers:y,file:{}});function x(){v.value=d,m.value=r}function b(n){m.value=c,v.value===d?i.value.users=n:v.value===f&&(o.value.users=n)}function w(){v.value=f,m.value=r}const $=B(()=>v.value===d?i.value.users:o.value.users);function E(n){n.length&&(o.value.file=n[0])}return j(async()=>{S.isLoading=!1,U=await Q("users")}),(n,t)=>A(S).isLoading?(l(),a("div",is,rs)):(l(),a(g,{key:1},[m.value===c?(l(),a("div",ds,[s("div",vs,[_s,i.value.users.length?(l(),a("ul",fs,[(l(!0),a(g,null,N(i.value.users,e=>(l(),a("li",null,u(C(e))+",  ",1))),256))])):p("",!0),s("div",ms,[s("div",ps,[s("div",hs,[bs,V(R,{modelValue:i.value.typeUsers,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value.typeUsers=e),options:k,name:"sms-subscribe-users"},null,8,["modelValue"])])]),s("div",ys,[i.value.typeUsers===h?(l(),a("button",{key:0,onClick:x,class:"btn btn-info"}," Вибрати користувачів ")):p("",!0)])]),s("div",xs,[s("div",gs,[s("div",Ss,"Символів: "+u(i.value.text.length),1),V(O,{modelValue:i.value.text,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value.text=e),name:"sms-subscribe-text",label:"Текст SMS"},null,8,["modelValue"])]),ks]),Us]),s("div",Cs,[Es,o.value.users.length?(l(),a("ul",Vs,[(l(!0),a(g,null,N(o.value.users,e=>(l(),a("li",null,u(C(e))+",  ",1))),256))])):p("",!0),s("div",ws,[s("div",$s,[s("div",As,[Ns,V(R,{modelValue:o.value.typeUsers,"onUpdate:modelValue":t[2]||(t[2]=e=>o.value.typeUsers=e),options:k,name:"email-subscribe-users"},null,8,["modelValue"])])]),s("div",Ps,[o.value.typeUsers===h?(l(),a("button",{key:0,onClick:w,class:"btn btn-info"}," Вибрати користувачів ")):p("",!0)])]),s("div",Rs,[s("div",js,[s("input",{onChange:t[3]||(t[3]=e=>E(e.target.files)),type:"file",name:"email-subscribe-file",class:"mb-2"},null,32),s("div",Ds,[Ls,s("span",Ms,u(o.value.file.name),1)]),Fs]),Os]),Ys])])):p("",!0),m.value===r?(l(),I(cs,{key:1,onSend:b,usersArr:A($)},null,8,["usersArr"])):p("",!0)],64))}};export{Js as default};
